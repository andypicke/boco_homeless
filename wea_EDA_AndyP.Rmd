---
title: "EDA - Andy Pickering"
output: 
  html_document: 
    keep_md: yes
    toc: yes
  html_notebook: 
    toc: yes
---


## Introduction

### (From Sam) Some of the interesting hypotheses we haven't explored yet are:
- How does weather affect daily bookings? weather: downtown-boulder-weather.csv. bookings: bookings-with-transient-status.csv (you'll need to aggregate this one up to the daily level)
- What proportion of jail bookings for housed/unhoused folks are for homelessness related charges? (by department? by year?) we pulled out charges that came from a list of antihomelessness ordinances compiled by some folks at Denver University, and marked them in the bookings dataset. If any of them were true, we marked the "antihomeless" column as true.


```{r}
suppressPackageStartupMessages(library(dplyr))
library(readr)
suppressPackageStartupMessages(library(lubridate))
library(ggplot2)
```


# Weather

```{r}
wea <- read_csv('/Users/Andy/Google Drive/boco-jail/downtown-boulder-weather.csv')
glimpse(wea)
```


```{r}
wea$DATE <- lubridate::ymd(wea$DATE)
head(wea)
```


```{r}
wea %>%
        ggplot(aes(DATE,TMAX))+
        geom_point() +
        ylab('Max Temp') +
        ggtitle('Downtown Boulder Weather')
```

```{r}
wea %>%
        ggplot(aes(DATE,PRCP))+
        geom_point() +
        ylim(0,3)
```


# Bookings

### Some info from Sam on the *bookings-with-transient-status.csv* data:
- These are bookings in Boulder County Jail.
- Each row was an individual booking.
- `boulder` means the arrest was made by Boulder PD
- Column `transient` for whether someone was homeless or not.
- I created indicator variables for a variety of antihomeless charges (that a local law school came up with). `antihomeless` is true if any of the antihomeless charges existed in the booking. So one source of error could be that if someone was arrested for an antihomeless charge AND a more serious offense, I still mark it as "antihomeless". 
- I don't remember making `any_antihomeless` -- I suspect it's identical to `antihomeless` and introduced by accident

```{r}
bk <- read_csv('/Users/Andy/Google Drive/boco-jail/bookings-with-transient-status.csv')
glimpse(bk)
```

### From Sam:
- Each row was an individual booking, with a column `transient` for whether someone was homeless or not.
- How many are transient?
```{r}
bk$transient = as.logical(bk$transient)
mean(bk$transient,na.rm = TRUE)
```

- 'antihomeless' is if any charges were related to 'antihomeless charges'
```{r}
bk$antihomeless <- as.logical(bk$antihomeless)
mean(bk$antihomeless)
```

### What percent of arrests were made by Boulder PD?
```{r}
bk$boulder <- as.logical(bk$boulder)
mean(bk$boulder)
```

```{r}
unique(bk$`Arresting Agency`)
```


### What agencies have the most arrests?
```{r}
bk$`Arresting Agency` <- as.factor(bk$`Arresting Agency`)
bk %>% rename(arrest_agency=`Arresting Agency`) %>%
        group_by(arrest_agency) %>%
        count() %>%
        arrange( desc(n) ) %>%
        ggplot(aes(x=reorder(arrest_agency,n),y=n))+
        geom_bar(stat='identity',aes(fill=arrest_agency)) +
        coord_flip()
```



### Aggregate Monthly
- I thought there would be more arrests in winter, but there doesn't seem to be that big of a difference.

```{r}
bk$month_ <- lubridate::month(bk$`Arrest Date`,label=TRUE)
bk$year <- lubridate::year(bk$`Arrest Date`)
bk %>% 
        filter(year %in% c(2011,2012,2013,2015,2015)) %>%
        group_by(month_) %>%
        count() %>%
        ggplot(aes(month_,n))+
        geom_point() +
        geom_bar(stat='identity',aes(fill=month_))
```


### Aggregate by wkday



### Try aggregating to daily level?
```{r}
bk %>% 
        filter(`Arrest Date`>"2000-01-01") %>%
        group_by(`Arrest Date`) %>%
        count() %>%
        ggplot(aes(`Arrest Date`,n)) +
        geom_point() +
        ylim(0,60) +
        geom_jitter() +
        geom_smooth(method="lm")
        
```


## Relationship between arrests and weather

```{r}

```



